library(tidyverse)
CDI <- read.table("CDI.txt")
options(scipen=999)
CDI_new=CDI%>%mutate(new=V5/V4)
X=CDI_new$V5
stem(X)
X=CDI_new$V4
stem(X)
X=CDI_new$V16
stem(X)
X=CDI_new$new
stem(X)
X=CDI_new$V7
stem(X)
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
pairs(CDI2)
cor(CDI2)
#Model 2:
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
pairs(CDI2)
cor(CDI2)
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)$r.squared
#Model II:
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)$r.squared#for model II
CDI_new=CDI%>%mutate(new=V5/V4)
21
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=y_hat, y=residuals, xlab="Yhat", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x1, y=residuals, xlab="x1", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x2, y=residuals, xlab="x2", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x3, y=residuals, xlab="x3", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
qqnorm(residuals)
qqline(residuals)
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x1*CDI2$x2, y=residuals, xlab="x1x2", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x1*CDI2$x3, y=residuals, xlab="x1x3", ylab="residuals")
22
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x2*CDI2$x3, y=residuals, xlab="x2x3", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=y_hat, y=residuals, xlab="Yhat", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x1, y=residuals, xlab="x1", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x2, y=residuals, xlab="x2", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x3, y=residuals, xlab="x3", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
qqnorm(residuals)
qqline(residuals)
23
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x2*CDI2$x1, y=residuals, xlab="x1x2", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x2*CDI2$x3, y=residuals, xlab="x2x3", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3, data=CDI2)
summary(fit)#for model II
residuals = fit$residuals
y_hat = fit$fitted.values
plot(x=CDI2$x1*CDI2$x3, y=residuals, xlab="X1X3", ylab="residuals")
abline(h=0, col="red")
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 5, 4, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3+x1*x2+x1*x3+x2*x3, data=CDI2)
fit
summary(fit)$r.squared
CDI_new=CDI%>%mutate(new=V5/V4)
CDI2=CDI_new[ , c(8, 18, 7, 16)]
colnames(CDI2) = c("y","x1","x2","x3")
fit = lm(y~x1+x2+x3+x1*x2+x1*x3+x2*x3, data=CDI2)
fit#for model II
summary(fit)$r.squared
Y = CDI[,8]
X1 = CDI[,5]
X2 = CDI[,16]
X3 = CDI[,4]
X4 = CDI[,7]
X5 = CDI[,9]
fit = lm(Y~X1 + X2)
anova(fit)
fit = lm(Y~X1 + X2 + X3)
anova(fit)
fit = lm(Y~X1 + X2 + X4)
anova(fit)
fit = lm(Y~X1 + X2 + X5)
anova(fit)
24
reduced=lm(Y~X1+X2)
full= lm(Y~X1+X2+X3)
library(knitr)
kable(anova(reduced,full))
full= lm(Y~X1+X2+X4)
kable(anova(reduced,full))
full= lm(Y~X1+X2+X5)
kable(anova(reduced,full))
fit = lm(Y~X1 + X2 + X5)
anova(fit)
alpha = 0.01
qf(1-alpha, 1, 436)
fit = lm(Y~X1 + X2 + X3 + X4)
anova(fit)
fit = lm(Y~X1 + X2 + X3 + X5)
anova(fit)
fit = lm(Y~X1 + X2 + X4 + X5)
anova(fit)
qf(1-alpha, 2, 435)
